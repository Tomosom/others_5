                   0                                     0                                                           0                                                                    0                                               0         0
                   s                                     s                                                           s                                                                    s                                                         s
                   s                                     s                                          (S3>             s                                         s震f                        s             子    此E                           0         s                                                                                                              3ddd〇x〇
                   ^                                     ^      (a>u)                                                ^                                                                    ^
                   m                                     m      蛔                                                    m                          - nvo.g          握                         m                                               0          ^m
                                                                       似                                                              Jpp< ys「s
                                                                       皿                s     l                                   {mdAJJP zl,                                                           -                                 0                        ^                   ROM BIOS
                                                                       仏                      i                                                                                                                                                                                                影子内存
                                                                       旺                頰  I     骀                                                                                                     m驶                                 X                        s
                                                                                                 掛                                                                                                                                        0                                                                  中關g务程序
                                                                 #                                                                                                                                 拭
                                                                 _厄                                                               仁                                                                懸    sola                                                       i                                                                                               30330X0 ddsoxo
             l     I                                     In      盎|                                                  I            ！                             I                      删  I         怵                                                 I            s                                 iii/tiii<i>
「l                 f     「l                              ff                                         -                f  n                                       f   「l                 张                                                              f            fI                                                                                  i
             $                  (-qeljopa/udmj-ul)                   -                             0寸                    f         寸i                                                      f                  s                            n-~^m-m-                                          ,,•,,'I>1<1,'>',11>i'<i1•i'i4'i>ii>i>i'iii'ii/*/ii•i•»
                                                                                                                                                                                p逛                                                        m-                                  0                                                                      1
$            lhl         $                                  r                                                     z     r                                           $           >                  <         f   oddddxo^qliF □ysstsola                  -                    0ddddds                                                               11    BIOS数据区
m            §                                                                                                          -                                                       - 账t                                                                     运®
              ®    sm                                    s                                s:                         s  ^                                       sm         y^                      担迆r
                                                         f                     te                                    f                                                               i                                                                   ft^
-Bs9-              f     -Bs9-                              ^-              ze§s妇 i     °                            s                                          f                    #             _                                                                           0
                   s                                                      ^                                                                                     s                   11-
                s                                     ^         (1>I)        《    5     g                                                                           -Bs9-            -)            胆叫#  IAI〇y                                                                  X000         // /                                                                   〇〇
                                                                             、    ^     i                                                                                                                                                                                                      1<111>I»1/11
                i                                        s                        w                                                                                                    距        o                                                                                      ISR                                                                         寸
                                                         ^
                                                      o  l  S                拒                                       ^S                                                    -                    o    蹓        铊4                        劳  m-                                                 />/>!1t      11!                                                      〇〇x〇 ddgoxo
                                                            W                                                                                                                                       刮        4闺                                                                             1 1 1 1 •'
00x                ^ 00x                                    I                                                                                                   ^ 00x                        O                                            x
                                                      ^                   ^掏                                         lW                                                                      W      佘-       丈                            o                    £                                 /1/1<>t/ 1/   //
                                                                                                                                                                                             S               囤                                                 d
s                  ls                             概_  i                   I  •、(  -a                                    I  卻      砌   ls                                                     S      哝                                     s                                                      ::1// /
                                                      i                   ^  &制   si                                       街      甶
趙y                    ^ 趙y                        厄                       I                                                習      垢                                 趙y                                                                                   d                             DAT  Z厂 1I :/•f ,y                                                 中断向量表
                                                                          i  撕       s-                                           佘                                 E
                                                                             街       s                                     盎I                                                                                                                                                               /4

                                                                                                                                                                                                                                                               d                            •:/

E      騮                 E      銮4                                                                                                                                                                 9SX
                      t         1                                                                                                                                                            S丨丨                                          I                    x                                                                                                   §00X0
       叵                                              •                                                                                                                                                                                丨

                                                                             子)      ^                                                                                                       S                                                           Yf somo- 
          -                                        1                          _                                                 -                                                              - 

                      ^                                                                                                                                                                      6

---------------------------------我是可爱的页面分割线-------------------------------------
狄泰未来                       © 2018成 都 狄 泰 未 来 科 技 有 限 公 司 唐 佐 林 _ 教 程

The shortest answer is doing.

                             编程实验

                           再论计算机的启动流程

狄泰未来                       © 2018成 都 狄 泰 未 来 科 技 有 限 公 司 唐 佐 林 _ 教 程

深入浅出x86中断机制

- 保护模式下的中断处理

     _使用中断描述符表映射不同中断与中断服务程序

    -中断描述符表（InterruptDescriptorTable)

           •可以包含中断门，陷阱门，任务门
           •门描述符

                       ，包含中断服务程序的入口（选择子：偏移）
                       ，包含各种用于合法性检查的属性（如：特权级）

狄泰未来                       © 2018成 都 狄 泰 未 来 科 技 有 限 公 司 唐 佐 林 _ 教 程

深入浅出x86中断机制

-  中 断 门 描 述 符 （Interrupt Gate) 的 定 义

      31 -16               15 1413 12 11-8 7 6 5 4321 0

      中断服务程序^地址2           P DPL S Type 0 0 0 Param 高 32位

                31 -16                                         15- 0       低 32位
                                                       中断服务程序備^地址1
      中断服务程序所在段

      Note:
      调用门，中断门，陷阱门的字段布局完全相同；当Type表示
      中断门（1110)和陷阱门（1111)时，Param字段未使用。

狄泰未来                       © 2018成 都 狄 泰 未 来 科 技 有 限 公 司 唐 佐 林 _ 教 程

深入浅出x86中断机制

-  中 断 描 述 符 表 （ IDT)

-中断描述表是中断描述符的线性集合（类似GDT)

-每个元素的大小为8字节（即••中断描述符）

-使用前将起始地址及界限载入丨DTR中（专用指定：lidt)

      [section .idt]          目齡， 参                    缴懷属性
      align 32             SelectorCode32, ISR_Entry,      0, DA_386IGate
      [bits 32]
      LABEL IDT:

      ;门
      %rep 255

                     Gate
      %endnep

      IdtLen               equ $ - LABEL_IDT
      IdtPtr               dw IdtLen - 1 ;段 界 限
                           dd 0 ;基 地 址

狄泰未来                       © 2018成 都 狄 泰 未 来 科 技 有 限 公 司 唐 佐 林 _ 教 程

深入浅出x86中断机制

- 保护模式下的中断处理

     -每个中断产生一个中断向量（中断类型号）

    -通过中断向量在IDT中查找对应的中断描述符
    _通过中断描述符中的选择子和偏移可找到ISR的入口地址

狄泰未来                       © 2018成 都 狄 泰 未 来 科 技 有 限 公 司 唐 佐 林 _ 教 程

深入浅出X86中断机制

- 保护模式下的中断处理

深入浅出x86中断机制

- 注意事项
     -IDT除了提供ISR入口地址，还提供了特权级等属性
     -中断发生后，转移执行ISR代码前需要进行特权级检查

     -实模式与保护模式的中断向量完全一致（硬件不变）

     -IDT中必须提供每种中断所对应的ISR入口地址

---------------------------------我是可爱的页面分割线-------------------------------------
狄泰未来  ◎ 2018成都狄泰未来科技有限公司

The shortest answer is doing

        编程实验

      保护模式下的中断方式

狄泰未来  ◎ 2018成都狄泰未来科技有限公司

深入浅出x86中断机制

-  To be continued ...

                  思考：
                         不同外设如何向处理器发送中断信号？

                   当多个外设同时产生中断时，如何进行处理?

狄泰未来                       i

      ◎ 2018成都狄泰未来科技有限公司

  狄泰未来

在这里收获的是未来，而不只是技术!
               交流群：199546072

                  ◎ 2018成都狄泰未来科技有限公司

---------------------------------我是可爱的页面分割线-------------------------------------
