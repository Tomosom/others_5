突 破 512字 节 的 限 制

■突破限制的预备工作

        __________________________       字符串打印

              辅助函数                  __________________________

                                          $姐读取

狄泰一+未来    © 2018成都狄泰未来科技有限公司                                    唐佐林视频教程

突破512字节的限制

■问题

        主引导程序中如何进行字符串打印？

狄泰一+未来            © 2018成都狄泰未来科技有限公司                            唐佐林视频教程

突破512字节的限制

■ BIOS中的字符串打印
    -指定打印参数（AX = 0x1301, BX = 0x0007 )
    -指定字符串的内存地址（ES:BP =串地址）
    -指定字符串的长度（CX =串长度）
    - 中 断 调 用 （int 0 x1 0 )

狄泰一+未来    © 2018成都狄泰未来科技有限公司                                    唐佐林视频教程

突破512字节的限制

■字符串打印示例

        mov a x , msg               ;指定字符串地址
        mov bp) ax
        mov a x , ds
        mov es, ax

        mov c x y 6                 :指定字符串长度

        mov ax, 0x1301 ;指定打印参数
        mov bXj 0x0007

        int 0x10

狄泰一+未来    ◎ 2018成都狄泰未来科技有限公司

突破512字节的限制

■汇编小贴士
    -汇编中可以定义函数（函数名使用标签定义）

            ♦ call function

          ♦函数体的最后—条指令为ret
    -如果代码中定义了函数，那么需要定义栈空间

          ♦ 用于保存关键寄存器的值
          ♦梭顶地址通过sp寄存器保存

狄泰一+未来            © 2018成都狄泰未来科技有限公司                            唐佐林视频教程

突破512字节的限制

■汇编小贴士
    - 汇 编 中 的 " 常 量 定义〃（equ )
         •用法：Const equ 0x7c00 ;#define Const 0x7c00
         •与 dx (db, dw, dd)的区别：
               ^ dx定义占用相应的内存空间
               ，equ定义不会占用任彳可内存空间

狄泰一+未来            © 2018成都狄泰未来科技有限公司                            唐佐林视频教程

The shortest answer is doing.

                       编程实验

                        定义打印函数
                              print

---------------------------------我是可爱的页面分割线-------------------------------------
狄泰一+未来        ◎ 2018成都狄泰未来科技有限公司                           唐佐林视频教程

突破512字节的限制

■问题

              主引导程序中如何读取指定扇
                        区处的数据？

狄泰料未来         © 2018成都狄泰未来科技有限公司                           唐佐林视频教程

突破512字节的限制

■软盘的构造

    -一个软盘有2个盘面，每个盘面对应1个磁头
    -每一个盘面被划分为若干个圆圏，成为柱面（磁道）
    -每一个柱面被划分为若干个扇区，每个扇区512字节

突破512字节的限制

■ 3.5寸软盘的数据特性
    -每个盘面一共80个拄面（编号为0 - 79 )
    一每个拄面有18个扇区（编号为1 - 18 )
    -存储大小：
          2 * 80 * 18 * 512 = 1474560 Bytes = 1440 KB

狄泰料未来         © 2018成都狄泰未来科技有限公司                           唐佐林视频教程

突破512字节的限制

■软盘数据的读取

     -软盘数据以扇区（512字节）为单位进行读取

     -指定数据所在位置的磁头号，拄面号，扇区号

     一计算公式：

                                            磁头号：Q&1

                                  -商Q -     _ 柱面号：Q > >1

              逻辑扇区号

              往面扇区数                         扇区号：R + 1

                                  L 余 R —►

m^^           ◎ 2013成都狄泰未来科技有限公司                           唐佐林视频敦程

突破512字节的限制

■ BIOS中的软盘数据读取（int 〇xl3 )

        中新号参数                               功能说明

        0x13  AH=0x00                        软驱复位
              DL=驱动器号（0表示A盘）
                                             从磁翻■雕读入
              AH=0x02
              AL=长度（扇区）                      ESrBX指向的内存

              CH =柱面号CL=起始扇区号                中
              DH=磁头号DL=驱动器号

              ES:BX=目标地址

狄泰一+未来        ◎ 2018成都狄泰未来科技有限公司                           唐佐林视频教程

突破512字节的限制

■ 软盘数据读取流程

                                             tsigg摄扇区电十算：

                                            柱面号，磁头号，扇区号

狄泰一+未来        ◎ 2018成都狄泰未来科技有限公司                           唐佐林视频教程

突破512字节的限制

     E编小贴士
     - '汇编中的16位除法操作（div )

          •被除数放到AX寄存器
          •除数放到通用寄存器或内存单元（8位）
          •结果：商位于AL , 余 数 位 于 AH

---------------------------------我是可爱的页面分割线-------------------------------------
狄泰夺+未来  ◎ 2018成都狄泰未来科技有限公司        唐佐林视频教程

The shortest answer is doing.

        编程实验

        磁盘数据的读取

狄泰夺+未来  ◎ 2018成都狄泰未来科技有限公司        唐佐林视频教程

 小结

■当汇编代码中定义了函数，那么也需要定义栈空间
■读取数据前，逻辑扇区号需要转化为磁盘的物理位置
■物理软盘上的数据位置由磁头号，柱面号，扇区号唯一确定
■软盘数据以扇区（512字爷）为单位进行读取

狄泰未来    ©2018成都狄泰未来科技有限公司         唐佐林视频教程

        狄泰未来

        在这里收获的是未来，而不只是技术!
              交流群：199546072

              ◎ 2018成都狄泰未来科技有限公司

---------------------------------我是可爱的页面分割线-------------------------------------
