深入雛级转移

■问题

                处理器通过什么规则判断资源请求或
                           代码繼是否合法？

狄泰一+未来               © 2018成都狄泰未来科技有限公司                              唐佐林视频教程

深入特权级转移

■数据段的访问规则（数据段无可执行属性)
    -访问者权限（CPL )高于或等于数据段特权级（DPL )
    -请求特权级（RPL)高于或等于数据段特权级（DPL)
    -gp : (CPL <= DPL) && (RPL <= DPL)

狄泰一+未来               ◎ 2018成都狄泰未来科技有限公司

深入特权级转移

■访问示例：
    一CPL = 2 , RPL = 1 , DPL = 3 , 访 问 是 否 合 法 ？
    一CPL = 0 , RPL = 3 , DPL = 2 , 访 问 是 否 合 法 ？
    一CPL = 0 , RPL = 1 , DPL = 2 , 访 问 是 否 合 法 ？

狄泰一+未来               © 2018成都狄泰未来科技有限公司                              唐佐林视频教程

The shortest answer is doing.

                       编程实验

                      数据段的访问规则
                      loader-19-l.asm

狄泰一+未来               © 2018成都狄泰未来科技有限公司                              唐佐林视频教程

深入特权级转移

■实验结论

     -选择子被段寄存器加载时，会进行保护模式的检查
           •检查选择子的下标是否合法（段描述符的合法性）

          •检查特权级是否合法（CPL& RPL <= DPL )
          •检查特权级时CPL和RPL之间不会进行比较

狄泰一+未来               © 2018成都狄泰未来科技有限公司                              唐佐林视频教程

深入特权级转移

■代码段的分类                                    - 系统段（ s = 0 )
    - 非系统段（s = 1 )                              ，LDT , TSS ,各种门结构
         z ^[性代码段
         ，非■^性代码段

31 — 24 23 22 21 20 19—16 15 14-13 12 11 — 8 7-0

段基址     G  D/B    L  AVL 段 界 限 P           DPL  S TYPE      段基址      高32位
31 -24                                                      23 - 16
                                  19 - 16

           31-16                                15-0

           段基址15-0                              段界限15 -- 0           低32位

狄泰一+未来               © 2018成都狄泰未来科技有限公司                              唐佐林视频教程

深入雛级转移

■非系统段的分类
    -一致注代码段：X = 1, C = 1
    一非一致性代码段：X = 1, C = 0

110 0*            1*              说明                               常量
110              0*
111                             可执行代码段                          DA_C = 0x98
                1*          可执行，可读代码段                         DA_CR = 0x9A
111                       可执行，一致性代码段                        DA一 CCO = Ox9C
                      可执行，可读，一致性代码段                         DA CCOR = Ox9E

                      TYPE字段

---------------------------------我是可爱的页面分割线-------------------------------------
狄泰夺今未来        ◎ 2018成都狄泰未来科技有限公司               唐佐林娜教程

深入特权级转移

■ 代码段之间的跳转规则（不借助门描述符）

     一+非一致性代码段

        •代码段之间只能平级转移（CPL== DPL，RPL <= DPL)

一       致注代码段

        •支持鹏权级代码向高觀级代码的转移（CPL>= DLP)

        •虽然可以成功转移高特权级代码段，但是当前特

               ◎ 2018成都狄泰未来科技有限公司              唐佐林视频教程

狄泰令+未来

深入特t又级转移

        数据段只有一种，没有一致性和非一致注的驗;
         并且，数据段不允许被低特权级的代码段访问°

               ◎ 2018成都狄泰未来科技有限公司              唐佐林视频教程

狄泰一今未来

The shortest answer is doing.

                 编程实验

               代码段的直接跳转规则

                 |〇ader-19-2.asm

               ◎ 2018成都狄泰未来科技有限公司              唐佐林视频教程

5火泰^未来

深入雛级转移

   ■实验结论

        -特权级降彳氏转移时，retf指令会触发栈段的特权级检查
        -_致性代码段可直擦■专到其它同级非一致性代码段执行

               © 2018成都狄泰未来科技有限公司              唐佐林视频教程

狄泰未来

   深入特t又级转移

        ■小技巧

               大多数情况下，选择子中的RPL和对应段
                  描述符中的DPL可设置为相同值！

        ■ CPL, RPL和DPL是处理进行特权级保护的依据
        ■ 对 于 数据段： CPL<=DPURPL<=DPL

        ■对于非一致性代码段：CPL = = DPL，RPL < = DPL
        ■对于_致注代码段•• CPL >= DPL ,转移后CPL不变

               © 2018成都狄泰未来科技有限公司                      唐佐林视频教程

        狄泰未来

          狄泰未来

        在这里收获的是未来，而不只是技术

                         交流群 199546072

                           ◎ 2018成都狄泰未来科技有限公司

---------------------------------我是可爱的页面分割线-------------------------------------
