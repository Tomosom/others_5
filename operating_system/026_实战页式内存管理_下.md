实战页式内存管理

- 课后疑问
             PageTable类的本质是一维数组，那么，为什么
               PCB类中的页表成员不直接使用一维数组?

狄泰未来        © 2018成都狄泰未来科技有限公司             唐佐林_教程

实战页式内存管理

- 设计准则

                  将未来可能出现的代码变动封装到局部。

            页表的表示方式可能出现变化吗?

狄泰未来        © 2018成都狄泰未来科技有限公司             唐佐林_教程

实战页式内存管理

- 根据程序运行的局部性原理

    -多数情况下，页表为稀疏状态
    -单级页表会浪费大量内存资源

- 二级页表

    -把页号分为两段：页目录+二级页号
    -如果下级页表的所有表项为空，那么页目录为空

狄泰未来        © 2018成都狄泰未来科技有限公司             唐佐林_教程

实战页式内存管理

- 课程设计目标：二级页表设计

页目录 页表地址

•     •

•     •

      •

4     NULL  二顿号 页框号

5     页表腿   --------------------> 0  0xE0

6     NULL  1                        0x10

            2                        0x31

•     •

•     •     3                        0x60

      _

狄泰未来        © 2018成都狄泰未来科技有限公司             唐佐林_教程

实战页式内存管理

- 具体设计

  -由于最大页号为OxFF,因此                          int* m_pt[PAGE_DIR_NUM];
    •页目录大小为(OxF + 1)
     •子页表大小为(〇xF + 1)                      / / ..........................

-页访问时将页号分解为两部分                             // access page i
     •高位部分访问页目录
     •低位部分访问下级页表                           int dir = ((i & 0xF0) >> 4);
                                           int spn = (i & 0x0F);

                                           if( m_pt[dir] == NULL )

                                           {一

                                                 m_pt[dir] = new int[PAGE_SUB_NUM];

                                                 for(int k=0; k<PAGE_SUB_Nm； k++)

                                                   {

                                                            m_pt[dir] [k] = FP_NONE;

                                                   }~
                                           }

                                           return m_pt[dir][spn];

狄泰未来        © 2018成都狄泰未来科技有限公司             唐佐林_教程

The shortest answer is doing.

            编程实验

            二级页表的实现
                 PageEx

狄泰未来        © 2018成都狄泰未来科技有限公司             唐佐林_教程

 小结

- 在实现上，页框表，页表和任务结构是相互关联的关系
- 页框分配和页框回收时需要斩断页框表和页表的双向关联
- 任务结构是任务的内在表示，包含了私有的页表
-  FIFO和LRU页交换算法都是从概率的角度选择页面移除
- 在设计上，将未来可能出现的代码变动封装到局部
-  多级页表的设计需要先对页号进行合理分割

---------------------------------我是可爱的页面分割线-------------------------------------
狄泰+今未来  ◎ 2018成都狄泰未来科技有限公司

 狄泰未来

在这里收获的是未来，而不只是技术!
          交流群：199546072

            © 2018成都狄泰未来科技薄艮公司

---------------------------------我是可爱的页面分割线-------------------------------------
